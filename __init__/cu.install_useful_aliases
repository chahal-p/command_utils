#!/usr/bin/env bash

source cu.errors_lib.bash

parsed=$(pflags parse --name "$(basename "$0")" --description "Install useful aliases of commands without cu namespace" ---- ---- "$@") || exit

eval set -- "$parsed"

while [[ $# -gt 0 ]]; do
  [[ "$1" == "--" ]] && shift && continue
  case $1 in
    --help)
      printf '%s' "$2"
      exit 0
      ;;
    *)
      cu.errors.die_usage "Unknown argument $1"
      ;;
  esac
done

complete_commands=()

cu.install_alias bin-to-hex=cu.bin-to-hex || exit
cu.install_alias cat-which=cu.cat.which || exit
cu.install_alias copy-to-clipboard=cu.copy-to-clipboard || exit
cu.install_alias confirm='cu.command -c --' || exit
cu.install_alias hex-to-bin=cu.hex-to-bin || exit
cu.install_alias less-which=cu.less.which || exit
cu.install_alias py-print=cu.python.print || exit
cu.install_alias vars-print=cu.vars.print || exit
cu.install_alias vim-which=cu.vim.which || exit

############ Date ############

complete_commands+=('complete -F _complete_cu.date.from-epoch date-from-epoch')

complete_commands+=('complete -F _complete_cu.date.to-epoch date-to-epoch')
cu.install_alias date-to-epoch=cu.date.to-epoch || exit

############ Openssl ############
complete_commands+=('complete -F _complete_cu.openssl.convert-x509-der-to-pem openssl-convert-x509-der-to-pem')
cu.install_alias openssl-convert-x509-der-to-pem=cu.openssl.convert-x509-der-to-pem || exit

complete_commands+=('complete -F _complete_cu.openssl.convert-x509-pem-to-der openssl-convert-x509-pem-to-der')
cu.install_alias openssl-convert-x509-pem-to-der=cu.openssl.convert-x509-pem-to-der || exit

complete_commands+=('complete -F _complete_cu.openssl.decode-asn1 openssl-decode-asn1')
cu.install_alias openssl-decode-asn1=cu.openssl.decode-asn1 || exit

complete_commands+=('complete -F _complete_cu.openssl.decode-cert openssl-decode-cert')
cu.install_alias openssl-decode-cert=cu.openssl.decode-cert || exit

complete_commands+=('complete -F _complete_cu.openssl.decode-crl openssl-decode-crl')
cu.install_alias openssl-decode-crl=cu.openssl.decode-crl || exit

complete_commands+=('complete -F _complete_cu.openssl.decode-csr openssl-decode-csr')
cu.install_alias openssl-decode-csr=cu.openssl.decode-csr || exit

complete_commands+=('complete -F _complete_cu.openssl.decode-key openssl-decode-key')
cu.install_alias openssl-decode-key=cu.openssl.decode-key || exit

complete_commands+=('complete -F _complete_cu.openssl.publickey-extract openssl-publickey-extract')
cu.install_alias openssl-publickey-extract=cu.openssl.publickey-extract || exit

complete_commands+=('complete -F _complete_cu.openssl.signature-extract openssl-signature-extract')
cu.install_alias openssl-signature-extract=cu.openssl.signature-extract || exit

complete_commands+=('complete -F _complete_cu.openssl.tbs-extract openssl-tbs-extract')
cu.install_alias openssl-tbs-extract=cu.openssl.tbs-extract || exit

printf '%s\n' "${complete_commands[@]}" | cu.persistent_source.add --sh bash -n _complete_useful_aliases -f -
